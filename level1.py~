import requests
import json
import time
import random

base_url = 'https://api.stockfighter.io/ob/api/venues/YPKEXEX/stocks/SSLM' 
headers = {"X-Starfighter-Authorization":"b361ec21edb4bc321b9647ca7fc0908c68259425"}


def get_quote():
    r = requests.get(base_url+'/quote',headers=headers)
    quote = json.loads(r.text)['ask']
    return quote

def buy_block(q,p):
    params = {'account':'AAR21283665','venue':'YPKEX','stock':'SSLM','price':p,'qty':q,'direction':'buy','orderType':'limit'}
    r = requests.post(base_url+'/orders',data=params,headers=headers)

#get quote, only accept stock prices w/in certain range of quote
init_quote = get_quote()

total = 0

#buy in blocks of 100
while(total < 100000):
    x = qet_quote()
    while(x > init_quote()*1.1):
        if(x!=0):time.sleep(random.random())
        x = get_quote()
    r = buy_block(100,x)
    total+=100
    
